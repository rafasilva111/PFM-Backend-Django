{% extends layout_path %}

{% load static %}
{% load i18n %}

{% block title %}Tables - Basic Tables{% endblock %}

{% block content %}

<h4 class="py-3 mb-4">
  <span class="text-muted fw-light">Recipe /</span> Create ETL Task
</h4>

{% if form.errors %}

<div class="bs-toast toast fade show bg-danger" role="alert" aria-live="assertive" aria-atomic="true" style="position: fixed; bottom: 20px; right: 20px; z-index: 1050; max-width: 300px;">
  <div class="toast-header">
    <i class="bx bx-bell me-2"></i>
    <div class="me-auto fw-medium">Bootstrap</div>
    <small>11 mins ago</small>
    <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
  </div>
  <div class="toast-body">
    {{ form.errors }}
  </div>
</div>

{% endif %}


<div class="col-md-12">
  <div class="card mb-4">
    <h5 class="card-header">Default</h5>
    <div class="card-body">
      <div>
        <form method="post">
          {% csrf_token %}
          
          <!-- Company field -->

          {{ form.company.label }}
          <div class="col-md-6 mt-2 mb-3">
            {{ form.company}}
          </div>

          <!-- Type field -->
           
          {{ form.type.label }}
          <div class="col-md-6 mt-2 mb-3">
            {{ form.type }}
          </div>
          
          <!-- Tasks Transformation field -->

          <div id="parent-tasks-transform" style="display: none;">
            {{ form.parent_tasks_transform.label_tag }}
            <div class="col-md-6 mt-2 mb-3">
              {{ form.parent_tasks_transform }}
            </div>
          </div>
          
          <!-- Tasks Extraction field -->
          
          <div id="parent-tasks-extract" style="display: none;">
              {{ form.parent_tasks_extract.label_tag }}
            <div class="col-md-6 mt-2 mb-3">
              {{ form.parent_tasks_extract }}
            </div>
          </div>

          <!-- Max records field -->
           
          {{ form.max_records.label }}
          <div class="col-md-6 mt-2 mb-3">
            {{ form.max_records }}
          </div>

          
      
          
          <button type="submit" class="btn btn-primary">
              Submit
          </button>

        </form>
      </div>
    </div>
  </div>
</div>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
  $(document).ready(function() {
    $('#id_type').change(function() {
      console.log($(this).val());
      if ($(this).val() === 'LOAD') {
        $('#parent-tasks-extract').hide()
        $('#parent-tasks-transform').show();
      } else if ($(this).val() === 'TRANSFORM') {
        $('#parent-tasks-transform').hide()
        $('#parent-tasks-extract').show();
      } else{
        $('#parent-tasks-extract').hide()
        $('#parent-tasks-transform').hide()

      }
    });
    
    // Trigger change event on page load if type is pre-selected
    $('#id_type').change();
  });
</script>
{% endblock %}
